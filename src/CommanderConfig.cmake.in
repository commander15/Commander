cmake_minimum_required(VERSION 3.20)

if (Commander_FOUND)
    return()
endif()

set(COMPONENTS
    Macros Internals
    CMakeSupport @Platform@Support
)

foreach (cmp ${COMPONENTS})
    set(Commander_FIND_REQUIRED_${cmp} TRUE)
endforeach()
set(Commander_FIND_COMPONENTS ${COMPONENTS} ${Commander_FIND_COMPONENTS})

unset(COMPONENTS)

foreach (cmp ${Commander_FIND_COMPONENTS})
    set(FILE ${CMAKE_CURRENT_LIST_DIR}/Commander${cmp}.cmake)

    if (EXISTS ${FILE})
        include(${FILE})
    elseif (Commander_FIND_REQUIRED_${cmp})
        message(FATAL_ERROR "Commander didn't find ${cmp} component")
    else()
        message(WARNING "Commander didn't find ${cmp} component")
    endif()
endforeach()

if (NOT CMAKE_GENERATOR STREQUAL Ninja)
    message(AUTHOR_WARNING "Commander: It seem that you use ${CMAKE_GENERATOR} generator, please consider to use Ninja for better performance.")
endif()
